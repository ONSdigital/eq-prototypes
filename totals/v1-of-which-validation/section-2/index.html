<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Totals v1 (of which - validation)</title>
  <meta name="description" content="                                            BETA    Totals v1 (of which - validation)        Previous  ">

  

  <link rel="stylesheet" href="/eq-prototypes/css/main.css">
  <link rel="stylesheet" href="/eq-prototypes/css/responsive.css">
  <link rel="canonical" href="http://onsdigital.github.io/eq-prototypes/totals/v1-of-which-validation/section-2/">
  <link rel="alternate" type="application/rss+xml" title="eQ Prototypes" href="http://onsdigital.github.io/eq-prototypes/feed.xml">
  <link rel='stylesheet prefetch' href='https://fonts.googleapis.com/css?family=Lato:300,400,600,700,900'>
  <link rel='stylesheet prefetch' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css'>
  <script src="/eq-prototypes/js/jquery.min.js"></script>
  <script type="text/javascript">
    document.addEventListener("touchstart", function(){}, true);
  </script>
</head>

  <body>
    <div class="page">
      <div class="page__content">
        <div class="skip">
          <a class="skip__link" href="#main">Skip to content</a>
        </div>
        <header class="page__header">
  <div class="container">
    <div class="header">
      <div class="logo header__logo">
        <img src="/eq-prototypes/s/img/logo.svg?q=b9a5e2a769014f162729655ec44ee5c5210bc8c3" alt="Office for National Statistics" class="logo__img" />
      </div>
      <!-- <div class="info header__info" role="contentinfo">
        <h3 class="info__title venus" id="survey-help">Survey Help</h3>
        <div class="info__tel">
          <a class="info__link" href="tel:03001234931" aria-describedby="survey-help">0300 1234 931</a>
        </div>
        <dl class="info__list">
          <dt class="info__dt first"><abbr title="Survey identification code">ID:</abbr></dt>
          <dd class="info__dd">023</dd>
          <dt class="info__dt">Period:</dt>
          <dd class="info__dd">May 2016</dd>
          <dt class="info__dt"><abbr title="Reference number">Ref:</abbr></dt>
          <dd class="info__dd last">12346789012A</dd>
        </dl>
      </div> -->
    </div>
  </div>

<div class="bar " role="banner">
  <div class="bar__inner container">
    <div class="badge badge--amber u-mr-xs">BETA</div>
    <div class="bar__title venus">Totals v1 (of which - validation)</div>
  </div>
</div>

</header>
<style>
.hidden {display: none;}
</style>
<div class="page__subheader">
  <div class="container">
    <a class="mars" href="../section-1">Previous</a>
  </div>
</div>

<div class="page__container container">
  <div class="grid grid--reverse">
    <div class="grid__col col-4@m">
    </div>
    <div class="grid__col col-7@m pull-1@m">
      <main role="main" id="main" class="page__main">

<!-- Error head start -->
    <div class="panel panel--error u-mb-s hidden" data-qa="error">
      <div class="panel__header">
        <h1 class="panel__title venus">This page has 1 error</h1>
      </div>
      <div class="panel__body" data-qa="error-body">
        <p class="mars">These <strong>must be corrected</strong> to continue.</p>
        <ul class="list list--bare">

            <li class="list__item mars">
              1) <a class="js-inpagelink" id="errorLink" href="#q2r1">Please amend this answer to continue.</a>
            </li>

          </ul>
        </div>
      </div>
<!-- End error head -->

        <form action="../thankyou" class="form qa-questionnaire-form" role="form" autocomplete="off" novalidate="">
          <div class="group" id="rsi">
            <div class="block" id="total-retail-turnover">
              <section class="section" id="total-retail-turnover-section">
                <h1 class="section__title neptune">
                  Employees
                </h1>
                <div class="question" id="total-retail-turnover-question">
                  <h2 class="question__title saturn">
                    Of the <span class="highlight "><span class="q1"></span></span> total employees how many of the following were in your employment on 12 December 2016?
                  </h2>
                  <div class="question__description mars" id="description-total-retail-turnover-question">
                    <p>Include employees at all sites working for <span class="config1">the business named on the front of the questionnaire</span>.</p>
                  </div>
                  <!-- <aside class="question__guidance">
                    <div class="panel panel--simple panel--info" id="question-guidance-total-retail-turnover-question">
                      <h3 class="venus">Include</h3>
                      <ul class="mars">
                        <li>VAT</li>
                        <li>internet sales</li>
                      </ul>
                      <h3 class="venus">Exclude</h3>
                      <ul class="mars">
                        <li>revenue from mobile phone network commission and top up </li>
                        <li>sales from catering facilities used by customers</li>
                        <li>lottery sales and commission from lottery sales</li>
                        <li>sales of car accessories and motor vehicles</li>
                        <li>NHS receipts</li>
                      </ul>
                    </div>
                  </aside> -->
                  <div class="question__answers">
                    <div class="question__answer">
                      <div class="answer answer--currency" id="aq2r1">

                        <div class="answer__fields js-fields">
                          <div class="field">
                            <label for="q2r1" id="label-total-retail-turnover-answer" class="label venus ">
                              <div class="label__inner">
                                Full-time males
                              </div>
                            </label>
                            <div class="input-type input-type--currency">
                              <!-- <span class="input-type__type" id="total-retail-turnover-answer-type">£</span> -->
                              <input id="q2r1" value="" data-qa="input-text" name="q2r1" class="input input--text">
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="question__answer">
                      <div class="answer answer--currency" id="aq2r2">
                        <div class="answer__fields js-fields">
                          <div class="field">
                            <label for="q2r2" id="label-total-retail-turnover-answer" class="label venus ">
                              <div class="label__inner">
                                Part-time males
                              </div>
                            </label>
                            <div class="input-type input-type--currency">
                              <!-- <span class="input-type__type" id="total-retail-turnover-answer-type">£</span> -->
                              <input id="q2r2" value="" data-qa="input-text" name="q2r2" class="input input--text">
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="question__answer">
                      <div class="answer answer--currency" id="aq2r3">
                        <div class="answer__fields js-fields">
                          <div class="field">
                            <label for="q2r3" id="label-total-retail-turnover-answer" class="label venus ">
                              <div class="label__inner">
                                Full-time females
                              </div>
                            </label>
                            <div class="input-type input-type--currency">
                              <!-- <span class="input-type__type" id="total-retail-turnover-answer-type">£</span> -->
                              <input id="q2r3" value="" data-qa="input-text" name="q2r3" class="input input--text">
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="question__answer">
                      <!-- Answer -->
                      <div class="answer answer--currency" id="aq2r4">
                        <div class="answer__fields js-fields">
                          <div class="field">
                            <label for="q2r4" id="label-total-retail-turnover-answer" class="label venus ">
                              <div class="label__inner">
                                Part-time females
                              </div>
                            </label>
                            <div class="input-type input-type--currency">
                              <!-- <span class="input-type__type" id="total-retail-turnover-answer-type">£</span> -->
                              <input id="q2r4" value="" data-qa="input-text" name="q2r4" class="input input--text">
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- Answer -->
                    </div>
                    <!-- <div class="question__answer">
                      <div class="answer answer--currency" id="total-retail-turnover-answer">
                        <div class="answer__fields js-fields">
                          <div class="field">
                            <label for="q2r5" id="label-total-retail-turnover-answer" class="label venus ">
                              <div class="label__inner">
                                Other goods
                              </div>
                            </label>
                            <div class="input-type input-type--currency">
                              <span class="input-type__type" id="total-retail-turnover-answer-type">£</span>
                              <input id="q2r5" value="" data-qa="input-text" name="q2r5" class="input input--text input-type__input">
                            </div>
                          </div>
                        </div>
                      </div>
                    </div> -->
                  </div>
                </div>
              </section>
            </div>
          </div>
          <button class="btn btn--primary btn--lg qa-btn-submit venus" type="submit" name="">Save and continue</button>
          <div class="u-mb-m">
            <button class="btn btn--link mars js-btn-save" type="submit" name="action[save_sign_out]">Save and complete later</button>
          </div>
        </form>
        <a class="page__previous page__previous--bottom js-previous-link" href="../section-1" id="bottom-previous">Previous</a>
      </main>
    </div>
  </div>
</div>
<script>
$( document ).ready(function() {
  if ($('.q1').length > 0) {
    var q1var = sessionStorage.getItem('q1r1');
    $('.q1').text(q1var);
  }
  if ($('.config1').length>0){
    var config1 = sessionStorage.getItem('config1');
    $('.config1').html(config1);
  }

  var q2r1_answer = sessionStorage.getItem('q2r1');
  if(q2r1_answer!==null){
    $('#q2r1').val(q2r1_answer);
  }
  var q2r2_answer = sessionStorage.getItem('q2r2');
  if(q2r2_answer!==null){
    $('#q2r2').val(q2r2_answer);
  }
  var q2r3_answer = sessionStorage.getItem('q2r3');
  if(q2r3_answer!==null){
    $('#q2r3').val(q2r3_answer);
  }
  var q2r4_answer = sessionStorage.getItem('q2r4');
  if(q2r4_answer!==null){
    $('#q2r4').val(q2r4_answer);
  }

  console.info(sessionStorage);

  $('.qa-btn-submit').click(function(e) {
    e.preventDefault();

    var val1 = (Number($("input[name='q2r1']").val()));
    var val2 = (Number($("input[name='q2r2']").val()));
    var val3 = (Number($("input[name='q2r3']").val()));
    var val4 = (Number($("input[name='q2r4']").val()));
    var totalVal = sessionStorage.getItem('q1r1');
    var errorPrep = '<div class="panel__header"><ul class="list list--bare list--errors"><li class="list__item mars" data-ga-action="Please correct the answer to continue." data-ga-label="single-date-question" data-ga="error" data-ga-category="Error"><p>Your answer is greater than the total.</p><p>Please correct the answer to continue.</p></li></ul></div>';

    if(val1 > totalVal || val2 > totalVal || val3 > totalVal || val4 > totalVal){ // if any of values 1 to 4 are > the total value (q1r1)
      $(".panel--error").toggleClass("hidden"); // then show the error panels

      if(val1 > totalVal){
        $('#errorLink').attr('href','#errorq2r1');
        $('#aq2r1 .answer__fields').wrap('<div class="panel__body" data-qa="error-body">').prepend(errorPrep);
        $('#aq2r1').wrap('<div class="answer answer--date js-has-errors" id="errorq2r1"><aside class="panel panel--simple panel--error" data-qa="error">');
        $(window).scrollTop(0); // faux submission behaviour - top of page.
        e.preventDefault();
        return false;
      }
      if (val2 > totalVal) {
        $("#errorLink").attr('href','#errorq2r2');
        $('#aq2r2 .answer__fields').wrap('<div class="panel__body" data-qa="error-body">').prepend(errorPrep);
        $('#aq2r2').wrap('<div class="answer answer--date js-has-errors" id="errorq2r2"><aside class="panel panel--simple panel--error" data-qa="error">');
        $(window).scrollTop(0); // faux submission behaviour - top of page.
        e.preventDefault();
        return false;
      }
      if (val3 > totalVal) {
        $("#errorLink").attr('href','#errorq2r3');
        $('#aq2r3 .answer__fields').wrap('<div class="panel__body" data-qa="error-body">').prepend(errorPrep);
        $('#aq2r3').wrap('<div class="answer answer--date js-has-errors" id="errorq2r3"><aside class="panel panel--simple panel--error" data-qa="error">');
        $(window).scrollTop(0); // faux submission behaviour - top of page.
        e.preventDefault();
        return false;
      }
      if (val4>totalVal) {
        $("#errorLink").attr('href','#errorq2r4');
        $('#aq2r4 .answer__fields').wrap('<div class="panel__body" data-qa="error-body">').prepend(errorPrep);
        $('#aq2r4').wrap('<div class="answer answer--date js-has-errors" id="errorq2r4"><aside class="panel panel--simple panel--error" data-qa="error">');
        $(window).scrollTop(0); // faux submission behaviour - top of page.
        e.preventDefault();
        return false;
      }
      window.location.href = "";
      return false;
    }
    else {
      if ((val1+val2+val3+val4)>totalVal) {
        //alert('Total error to be fired now please!');
        $('.panel--error').toggleClass('hidden');
        e.preventDefault();
      }
    }

        if ("text" === "text") {

          var inputValue = $("input[name='q2r1']").val();
          sessionStorage.setItem('q2r1', inputValue);
          var inputValue = $("input[name='q2r2']").val();
          sessionStorage.setItem('q2r2', inputValue);
          var inputValue = $("input[name='q2r3']").val();
          sessionStorage.setItem('q2r3', inputValue);
          var inputValue = $("input[name='q2r4']").val();
          sessionStorage.setItem('q2r4', inputValue);
          // var inputValue = $("input[name='q2r5']").val();
          // sessionStorage.setItem('q2r5', inputValue);
        } else {
          // var inputValue = $("input[name='q1']:checked").val();
          // sessionStorage.setItem('q1', inputValue);
          var inputValue = $("input[name='q2r1']:checked").val();
          sessionStorage.setItem('q2r1', inputValue);
          var inputValue = $("input[name='q2r2']:checked").val();
          sessionStorage.setItem('q2r2', inputValue);
        }
window.location.href = "../thankyou"; // target of save and continue
  });

});
</script>

      </div>
      <footer class="page__footer">
  <div class="footer page__footer" role="contentinfo">
    <div class="container">
      <div class="pluto">© <a class="footer__link" href="https://www.ons.gov.uk/" target="_blank">Office for National Statistics 2016</a></div>
    </div>
  </div>
</footer>

    </div>
    <!-- Uncomment for Loop 11 <script type="text/javascript">
      var loop11_key = "0104054b3b56d396b42e668dfe096cee161454a8";
      var l11_clientOptions = {"cookieDomain":".github.io"};
      document.write(unescape("%3cscript src='//cdn.loop11.com/my/loop11.js' type='text/javascript'%3e%3c/script%3e"));
    </script> -->
  </body>
</html>
