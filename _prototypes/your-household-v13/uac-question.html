---
title: Household prototype v13
project: your-household
globalcss: false
layout: eq-default-extras
assetPrefixUrl: https://sdc-global-design-patterns.netlify.com
---

<link rel="stylesheet" href="../style.css"/>
<div class="page__subheader">
    <div class="container">
        <a class="js-previous-link" href="../individual-decision-answer-behalf">Previous</a>
    </div>
</div>

<div class="page__container container">
    <div class="grid">
        <div class="grid__col col-7@l">
            <main role="main" id="main" class="page__main">
                <div class="group u-mb-l">
                    <div class="block">
                        <section class="section">
                            <form autocomplete="off">
                                <div class="question u-mb-s">
                                    <h1 id="question-title" class="question__title u-fs-l js-piping">{x}{s} questions</h1>
                                    <p class="js-piping">If you want {x} to complete their own questions, they will need the unique access code from the census letter we sent you.</p>
                                    <p>Alternatively, you can request a separate survey for them to complete.</p>

                                    <fieldset class="field field--radio field--multiplechoice ">
                                        <legend class="u-vh js-piping">{x}{s} questions</legend>
                                        <div class="field__item js-focusable-box">
                                            <input class="input input--radio js-focusable" type="radio" name="response-options" id="give-code">
                                            <label class="label label--inline" for="give-code">I will give them the code and ask them to complete their own questions</label>
                                        </div>

                                        <div class="field__item js-focusable-box">
                                            <input class="input input--radio js-focusable" type="radio" name="response-options" id="new-survey">
                                            <label class="label label--inline" for="new-survey">I would like to request a separate survey for them to complete</label>
                                        </div>

                                        <span class="u-fs-r--b u-d-b u-mb-s u-mt-s" aria-hidden="true">Or</span><br>

                                        <div class="field__item js-focusable-box">
                                            <input class="input input--radio js-focusable" type="radio" name="response-options" id="complete-questions">
                                            <label class="label label--inline" for="complete-questions"><span class="u-vh">or, </span>I will continue to answer their questions</label>
                                        </div>
                                    </fieldset>

                                    <button class="btn btn--primary btn--lg qa-btn-submit venus u-mt-xl u-mb-xl" type="submit" name="">Continue</button>
                                </div>
                            </form>
                        </section>
                    </div>
                </div>
            </main>
        </div>
    </div>
</div>

<script>
    var cannotAnswerPeople = JSON.parse(sessionStorage.getItem('cannot-answer-people') || '[]');
    var searchParams = new URLSearchParams(window.location.search);
    var personId = searchParams.get('person_id');

    if (!personId) {
        personId = cannotAnswerPeople[0].id;
    }

    var person = JSON.parse(sessionStorage.getItem('household-members')).find(function(person) { 
        return person['@person'].id === personId;
    })['@person'];

    var pipingDestinations = Array.from(document.querySelectorAll('.js-piping'));
    var possessive = person.fullName.slice(-1) === 's' ? "'" : "'s";

    pipingDestinations.forEach(function(pipingDestination) {
        pipingDestination.innerHTML = pipingDestination.innerHTML.replace('{x}', person.fullName).replace('{s}', possessive);
    });

    var cannotAnswerPerson = cannotAnswerPeople.find(function(p) {
        return p.id === person.id;
    });

    if (!cannotAnswerPerson) {
        cannotAnswerPerson = {
            id: person.id,
            responseOption: null,
            phoneNumber: null,
        };

        cannotAnswerPeople.push(cannotAnswerPerson)
    }

    if (cannotAnswerPerson.responseOption) {
        document.getElementById(cannotAnswerPerson.responseOption).checked = true;
    }

    var form = document.querySelector('form');
    
    form.addEventListener('submit', function(event) {
        event.preventDefault();

        var responseOption = Array.from(document.querySelectorAll('input[type=radio]')).find(function(radio) {
            return radio.checked;
        }).id;

        cannotAnswerPerson.responseOption = responseOption;

        sessionStorage.setItem('cannot-answer-people', JSON.stringify(cannotAnswerPeople));

        switch (responseOption) {
            case 'new-survey': {
                window.location.href = '../request-survey?person_id=' + personId;
                break;
            }
            case 'complete-questions': {
                window.location.href = '../individual-intro/?person=' + personId;
                break;
            }
            default: {
                var nextPerson = cannotAnswerPeople.find(function(person) {
                    return !person.responseOption;
                });

                /*cannotAnswerPeople = cannotAnswerPeople.filter(function(person) {
                    return person.id !== personId;
                });

                sessionStorage.setItem('cannot-answer-people', JSON.stringify(cannotAnswerPeople));*/

                if (nextPerson) {
                    window.location.href = '../uac-question?person_id=' + nextPerson.id;
                } else {
                    window.location.href = '../hub';
                }
            }
        }
    });
</script>